{"componentChunkName":"component---src-templates-blog-post-js","path":"/typescript-generic-constraint/","result":{"data":{"markdownRemark":{"html":"<p>Any statically-typed language supports <em>generic</em>, <a href=\"https://www.typescriptlang.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Typescript</a> is no exception. With generic, we can write a flexible type signature that encourages reusability for our functions. Without it, functions are restricted to one specific data type which in turn, makes it hard to reuse.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">function</span> <span class=\"token function\">createArray</span><span class=\"token punctuation\">(</span>items<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\"><span class=\"token builtin\">Array</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>In the example above, the function <code class=\"language-text\">createArray</code> accepts an array of <code class=\"language-text\">string</code> and outputs an array of <code class=\"language-text\">string</code>. Depending on the use case, but we can <em>improve</em> this function by giving it a generic type such that it accepts more than just <code class=\"language-text\">string</code> type.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">createArray</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>items<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token generic-function\"><span class=\"token function\">createArray</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Hitchhiker'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Guide'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'To'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'The'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Galaxy'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅\n<span class=\"token generic-function\"><span class=\"token function\">createArray</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token builtin\">number</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">42</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅\n<span class=\"token function\">createArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Life'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">42</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> ✅ <span class=\"token comment\">// `string | number`</span></code></pre></div>\n<p>With generic, we can enforce our <code class=\"language-text\">createArray</code> function to accept and return a specific type.</p>\n<p>In addition, omitting the type will cause the <code class=\"language-text\">createArray</code> function to infer the type from the argument (<code class=\"language-text\">[&#39;Life&#39;, 43]</code> is translated into <code class=\"language-text\">string | number</code>). This looks great, our function can be reused with different type signatures.</p>\n<p>However, a lot of times when writing a generic function, we might have some prior knowledge about how our function works underneath and therefore we can narrow down the type. In Typescript, this is called <strong>Generic Constraint</strong>.</p>\n<h2>Understanding Generic Constraint</h2>\n<p>A <a href=\"https://www.typescriptlang.org/docs/handbook/2/generics.html#generic-constraints\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">generic constraint</a> is simply a way to put some constraints to a type. Suppose we have a generic function like this,</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">getStuff</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>arg<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hitchhiker's Guide to the Galaxy\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅\n<span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅\n<span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅\n<span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅\n<span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅\n<span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅</code></pre></div>\n<p>You'll notice that <code class=\"language-text\">null</code> and <code class=\"language-text\">undefined</code> are allowed here, it might be what we wanted, but I'm sure most of the time these are invalid inputs. To solve this, we can put a constraint on our generic type to disallow empty value.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">getStuff</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span> <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>arg<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token string\">'asdsad'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅\n<span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅\n<span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅\n<span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅\n<span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ❌\n<span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ❌</code></pre></div>\n<p>In the example above, <code class=\"language-text\">T extends {}</code> means that <code class=\"language-text\">T</code> can be any type that is a subclass of <code class=\"language-text\">{}</code> (an object), in Javascript <code class=\"language-text\">string</code>, <code class=\"language-text\">number</code>, <code class=\"language-text\">array</code> and <code class=\"language-text\">object</code> are all subclasses of <code class=\"language-text\">object</code>, while <code class=\"language-text\">undefined</code> and <code class=\"language-text\">null</code> are not, therefore they are disallowed. This is what generic constraint syntax look like, by extending the <code class=\"language-text\">T</code> type.</p>\n<h3>Generic Type With Specific Behavior</h3>\n<p>Somewhere in our function, we might invoke a specific method of the argument, but with generic, we can't be sure such property exists. Therefore we need to further constraint our function to only accept an argument with a specific signature.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">Lengthwise</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  length<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">getLength</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span> <span class=\"token keyword\">extends</span> Lengthwise<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>arg<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">number</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> arg<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">getLength</span><span class=\"token punctuation\">(</span><span class=\"token string\">'asdsad'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅ <span class=\"token comment\">// 6</span>\n<span class=\"token function\">getLength</span><span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ❌\n<span class=\"token function\">getLength</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ❌\n<span class=\"token function\">getLength</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ✅ <span class=\"token comment\">// 0</span>\n<span class=\"token function\">getLength</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ❌\n<span class=\"token function\">getLength</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ❌</code></pre></div>\n<p>In the example above, only <code class=\"language-text\">string</code> and <code class=\"language-text\">array</code> have property <code class=\"language-text\">.length</code> while the rest are disallowed.</p>\n<h3>Get What You Ask For</h3>\n<p>Now that we've gained some ground, let's see how we can perform a more advanced constraining with Typescript. Suppose we want to create a function that accepts a custom shape and return the exact same shape like this, </p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n  foo<span class=\"token punctuation\">,</span>\n  bar\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  foo<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  bar<span class=\"token operator\">:</span> <span class=\"token string\">''</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This is a perfect case for generic constraints. Let's start by defining our custom type.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">CustomObject</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  foo<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  bar<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  baz<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Our custom type has three fields: <code class=\"language-text\">foo</code>, <code class=\"language-text\">bar</code>, and <code class=\"language-text\">baz</code>. The argument can be a full set or a subset of <code class=\"language-text\">CustomObject</code>, to solve this we can use the Typescript built-in type <code class=\"language-text\">Partial</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">getStuff</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span> <span class=\"token keyword\">extends</span> Partial<span class=\"token operator\">&lt;</span>CustomType<span class=\"token operator\">>></span></span></span><span class=\"token punctuation\">(</span>arg<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token constant\">T</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n  foo<span class=\"token punctuation\">,</span> <span class=\"token comment\">// ✅ </span>\n  bar<span class=\"token punctuation\">,</span> <span class=\"token comment\">// ✅</span>\n  baz <span class=\"token comment\">// ❌ `baz` does not exist on type `{ foo: string; bar: string; }`</span>\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  foo<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  bar<span class=\"token operator\">:</span> <span class=\"token string\">''</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Perfect! Our function returns exactly the shape we asked for no more and no less. Note that the empty string <code class=\"language-text\">&#39;&#39;</code> is simply a placeholder value to fulfill the object shape, it doesn't actually do anything (we can customize it though).</p>\n<p>Alternatively, if you dislike the fact that we use an object to define the shape, we can also do it like this,</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">StuffRequest</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">keyof</span> CustomType<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">StuffResponse<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span> <span class=\"token keyword\">extends</span> StuffRequest<span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">[</span>k <span class=\"token keyword\">in</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> CustomType<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">getStuff</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span> <span class=\"token keyword\">extends</span> StuffRequest<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> StuffResponse<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n  foo<span class=\"token punctuation\">,</span>\n  baz<span class=\"token punctuation\">,</span>\n  bar <span class=\"token comment\">// ❌ `bar` does not exist on type `StuffResponse&lt;'foo' | 'baz'>`</span>\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">getStuff</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'baz'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Which one is better, you decide.</p>","frontmatter":{"title":"Narrow Down Types With Typescript Generic Constraints","date":"2022-01-08","shortDesc":"How to unleash the real power of Typescript generics","featuredImage":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAwL/2gAMAwEAAhADEAAAAaEczplNmTSpxDPNwoq//8QAHRAAAgIDAAMAAAAAAAAAAAAAAQIDEgAEESExMv/aAAgBAQABBQLojFi7DJHN4/fMj1eM1VNwubTFYh4ij+P/xAAZEQACAwEAAAAAAAAAAAAAAAAAEQEQIRL/2gAIAQMBAT8B6dZGDP/EABoRAAICAwAAAAAAAAAAAAAAABARAQIDISL/2gAIAQIBAT8BS2Mbt1I//8QAHRAAAgEEAwAAAAAAAAAAAAAAAAEREBIhUTFBkf/aAAgBAQAGPwLbMqnMwXdUl+FuiLoMMcCP/8QAHRAAAgICAwEAAAAAAAAAAAAAAREAITGBUWFxkf/aAAgBAQABPyEEFrguQDs3qGUfeIQlR/YSXkT9hsaJ7lptGuUpDIyRqIt55hpUyjCeyCA3MymbM//aAAwDAQACAAMAAAAQ+O1z/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERIf/aAAgBAwEBPxBViLDWEJz/xAAYEQEAAwEAAAAAAAAAAAAAAAABABExEP/aAAgBAgEBPxAqdrzcSif/xAAfEAEAAgICAgMAAAAAAAAAAAABESEAUTFBYZFxsdH/2gAIAQEAAT8Qi49h08YNn8h3DTCAxSCnE5KVBEkIN1rKgtSbTb795xRZaVORUfMhEh5fHcZDAFKgCvHzPWsDDMuYq9/mSiM2NRxiUxXaBL73nKCCRBVc/9k=","aspectRatio":0.7511737089201878,"src":"/static/dda72bd4de937e1f01a8a0aab547992b/f422e/generic_constraint.jpg","srcSet":"/static/dda72bd4de937e1f01a8a0aab547992b/e75b5/generic_constraint.jpg 160w,\n/static/dda72bd4de937e1f01a8a0aab547992b/c01e2/generic_constraint.jpg 320w,\n/static/dda72bd4de937e1f01a8a0aab547992b/f422e/generic_constraint.jpg 640w,\n/static/dda72bd4de937e1f01a8a0aab547992b/a6352/generic_constraint.jpg 960w,\n/static/dda72bd4de937e1f01a8a0aab547992b/ec6c5/generic_constraint.jpg 1280w","sizes":"(max-width: 640px) 100vw, 640px"}}}},"timeToRead":4,"excerpt":"Any statically-typed language supports generic, Typescript is no exception. With generic, we can write a flexible type signature that…","fields":{"slug":"/typescript-generic-constraint/"}}},"pageContext":{"slug":"/typescript-generic-constraint/"}},"staticQueryHashes":["3649515864","572726844"]}